group TestGenerator;

deflt(elem) ::= <<
    <elem; separator="\n">
>>
combinedTemplate(content) ::= <<
<content; separator="\n">
>>

initTestClassWithBaseUrl(package, className, url, content) ::= <<
package <package>;

import io.restassured.RestAssured; // REST-assured library
import io.restassured.http.ContentType; // REST-assured dependency
import org.junit.jupiter.api.*; // JUnit

import static io.restassured.RestAssured.given; // REST-assured given method
import static org.hamcrest.Matchers.*; // Hamcrest matchers

class <className> {

    @BeforeEach
    public void setup() {
        RestAssured.baseURI = "http://localhost";
        RestAssured.port = port;
        RestAssured.basePath = "/api/example";
    }

<content>
}
>>
initTestClass(package, name, content) ::= <<
package <package>;

import io.restassured.RestAssured; // REST-assured library
import io.restassured.http.ContentType; // REST-assured dependency
import org.junit.jupiter.api.*; // JUnit

import static io.restassured.RestAssured.given; // REST-assured given method
import static org.hamcrest.Matchers.*; // Hamcrest matchers

class <className> {

<content>
>>
initTestMethod(name, request, assert, close) ::= <<
    @Test
    void <name>() {
        given()
<request>
<assert>;
    }
>>


baseUri(uri) ::= <<
                .baseUri("<uri>")
>>
port(port) ::= <<
                .port(<port>)
>>
basePath(path) ::= <<
                .basePath("<path>")
>>

requestWithPortAndPath(uri, port, path) ::= <<
<baseUri(uri)>
<port(port)>
<basePath(path)>
>>
requestWithPath(uri, path) ::= <<
<baseUri(uri)>
<basePath(path)>
>>
request(uri) ::= <<
<baseUri(uri)>
>>

requestHeaders(headerKey, headerValue) ::= <<
                .header("<headerKey>", "<headerValue>")
>>

requestQueryParams(queryKey, value) ::= <<
                .queryParam("<queryKey>", <value>)
>>

getRequest(path) ::= <<
            .when()
                .get(<path>)
            .then()
>>
postRequest(path) ::= <<
            .when()
                .post("<path>")
            .then()
>>
putRequest(path) ::= <<
            .when()
                .put("<path>")
            .then()
>>
patchRequest(path) ::= <<
            .when()
                .patch("<path>")
            .then()
>>
deleteRequest(path) ::= <<
            .when()
                .delete("<path>")
            .then()
>>


assertStatusCode(code) ::= <<
                .statusCode(<code>)
>>
assertBodyContains(prop) ::= <<
                .body("<prop>", notNullValue())
>>
assertBodyExact(prop, value) ::= <<
                .body("<prop>", equalTo(<value>))
>>
assertResponseHeader(header, value) ::= <<
                .header("<header>", containsString("<value>"))
>>
